{"version":3,"sources":["components/PriceBarChart.js","pages/Fund/TargetReturn.js"],"names":["PriceBarChart","props","data","fullProfitPrice","lossPrice","currentPrice","barSize","barGap","stroke","width","padding","top","bottom","axisLine","tickLine","tick","fontWeight","value","offset","position","style","textAnchor","angle","fill","dataKey","y","strokeDasharray","label","TargetReturn","account","useWeb3Context","daiBalance","useDaiBalance","useDaiAllowance","daiAllowance","allowance","daiApprove","approve","useState","daiApprovePending","setDaiApprovePending","useFundDates","purchaseExpiringDate","redeemStartingDate","daiFundUnits","useDaiFundUnits","rate","useRate","daiPool","useDaiPool","ethPool","useEthPool","daiInvestorAmount","useDaiInvestorAmount","daiToEthRate","usePriceConvertionRate","currentEthPrice","purchaseDaiFund","useDaiFundPurchase","redeemDaiFund","useDaiFundRedeem","addTransaction","useTransactionAdder","amount","setAmount","connected","useMemo","totalPoolInEth","times","plus","priceToGetFullProfit","div","priceToGetLoss","chartData","toNumber","onApprove","useCallback","a","hash","onPurchase","amountParsed","BigNumber","toString","onRedeem","canPurchase","Date","now","canRedeem","strong","amountFormatter","type","placeholder","onChange","event","target","className","disabled","lt","onClick","dateFormatter","justifyBetween","toFixed","height"],"mappings":"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","file":"static/js/8.40a164a5.chunk.js","sourcesContent":["import React from 'react'\nimport {\n  ResponsiveContainer,\n  BarChart,\n  Bar,\n  ReferenceLine,\n  YAxis,\n  Label,\n} from 'recharts'\n\nexport default function PriceBarChart(props) {\n  const { data } = props\n  const { fullProfitPrice, lossPrice, currentPrice } = data\n  return (\n    <ResponsiveContainer>\n      <BarChart data={[data]} barSize={40} barGap={40}>\n        <YAxis\n          stroke='#FFFFFF'\n          width={80}\n          padding={{ top: 30, bottom: 30 }}\n          axisLine={false}\n          tickLine={false}\n          tick={{ fontWeight: 500 }}\n        >\n          <Label\n            value='ETH Price'\n            offset={10}\n            position='insideLeft'\n            style={{ textAnchor: 'middle' }}\n            angle={-90}\n            fill='#FFFFFF'\n            fontWeight={500}\n          />\n        </YAxis>\n        <Bar dataKey='currentPrice' fill='#00C8FF' />\n        <Bar dataKey='fullProfitPrice' fill='#00FF8C' />\n        <Bar dataKey='lossPrice' fill='#FF4D53' />\n        <ReferenceLine\n          y={fullProfitPrice}\n          stroke='#FF4D53'\n          strokeDasharray='5 5'\n        >\n          <Label\n            value='Profit Price'\n            fill='#FFFFFF'\n            fontWeight={500}\n            position='insideRight'\n          />\n        </ReferenceLine>\n        <ReferenceLine y={lossPrice} stroke='#FF4D53' strokeDasharray='5 5'>\n          <Label\n            value='Break Even'\n            fill='#FFFFFF'\n            fontWeight={500}\n            position='insideRight'\n          />\n        </ReferenceLine>\n        <ReferenceLine\n          y={currentPrice}\n          label='Current Price'\n          stroke='#FF4D53'\n          strokeDasharray='5 5'\n        >\n          <Label\n            value='Current Price'\n            fill='#FFFFFF'\n            fontWeight={500}\n            position='insideRight'\n          />\n        </ReferenceLine>\n      </BarChart>\n    </ResponsiveContainer>\n  )\n}\n","import React, { useMemo, useState, useCallback } from 'react'\nimport { useWeb3Context } from 'web3-react'\nimport { useTransactionAdder } from '../../contexts/transaction'\nimport {\n  usePriceConvertionRate,\n  useDaiBalance,\n  useDaiAllowance,\n} from '../../hooks/ethereum'\nimport {\n  useRate,\n  useDaiPool,\n  useDaiInvestorAmount,\n  useDaiFundUnits,\n  useDaiFundPurchase,\n  useDaiFundRedeem,\n  useEthPool,\n  useFundDates,\n} from '../../hooks/fund'\nimport { amountFormatter, dateFormatter } from '../../utils'\nimport { Container, Row, SubRow } from '../../themes/layout'\nimport {\n  Headline,\n  Title,\n  SubTitle,\n  Text,\n  StrongText,\n  Bold,\n} from '../../themes/typography'\nimport {\n  PurchaseBlock,\n  PurchaseBlockTop,\n  PurchaseBlockBottom,\n  PurchaseInfo,\n  PurchaseDate,\n  DataBlock,\n} from '../../themes/block'\nimport {\n  PurchaseForm,\n  PurchaseInputField,\n  PurchaseButton,\n} from '../../themes/form'\nimport PriceBarChart from '../../components/PriceBarChart'\nimport { ReactComponent as Item } from '../../assets/item.svg'\nimport BigNumber from 'bignumber.js'\n\nexport default function TargetReturn() {\n  const { account } = useWeb3Context()\n\n  const daiBalance = useDaiBalance()\n  const { allowance: daiAllowance, approve: daiApprove } = useDaiAllowance()\n  const [daiApprovePending, setDaiApprovePending] = useState(false)\n\n  const { purchaseExpiringDate, redeemStartingDate } = useFundDates()\n  const daiFundUnits = useDaiFundUnits()\n  const rate = useRate()\n  const daiPool = useDaiPool()\n  const ethPool = useEthPool()\n  const daiInvestorAmount = useDaiInvestorAmount()\n  const daiToEthRate = usePriceConvertionRate('DAI', 'ETH')\n  const currentEthPrice = usePriceConvertionRate('ETH', 'USD')\n\n  const purchaseDaiFund = useDaiFundPurchase()\n  const redeemDaiFund = useDaiFundRedeem()\n  const addTransaction = useTransactionAdder()\n\n  const [amount, setAmount] = useState('') // purchase amount\n\n  const connected = useMemo(() => !!account, [account])\n\n  const totalPoolInEth = useMemo(\n    () =>\n      daiPool && ethPool && daiToEthRate\n        ? daiPool.times(daiToEthRate).plus(ethPool)\n        : null,\n    [daiPool, ethPool, daiToEthRate],\n  )\n\n  const priceToGetFullProfit = useMemo(\n    () =>\n      daiPool && totalPoolInEth ? daiPool.times(1.2).div(totalPoolInEth) : null,\n    [daiPool, totalPoolInEth],\n  )\n\n  const priceToGetLoss = useMemo(\n    () => (daiPool && totalPoolInEth ? daiPool.div(totalPoolInEth) : null),\n    [daiPool, totalPoolInEth],\n  )\n\n  const chartData = useMemo(() => {\n    const fullProfitPrice = priceToGetFullProfit\n      ? priceToGetFullProfit.toNumber()\n      : 0\n    const lossPrice = priceToGetLoss ? priceToGetLoss.toNumber() : 0\n    const currentPrice = currentEthPrice ? currentEthPrice.toNumber() : 0\n    return {\n      fullProfitPrice,\n      lossPrice,\n      currentPrice,\n    }\n  }, [priceToGetFullProfit, priceToGetLoss, currentEthPrice])\n\n  const onApprove = useCallback(async () => {\n    const onTransactionHash = hash => {\n      addTransaction(hash)\n      setDaiApprovePending(true)\n    }\n    const onConfirmation = () => {\n      setDaiApprovePending(false)\n    }\n    const onError = () => {\n      setDaiApprovePending(false)\n    }\n    daiApprove(onTransactionHash, onConfirmation, onError)\n  }, [daiApprove, addTransaction])\n\n  const onPurchase = useCallback(async () => {\n    const amountParsed = new BigNumber(amount).times(1e18).toString()\n    const onTransactionHash = hash => {\n      addTransaction(hash)\n    }\n    const onConfirmation = () => {\n      setAmount('')\n    }\n    const onError = () => {\n      setAmount('')\n    }\n    purchaseDaiFund(amountParsed, onTransactionHash, onConfirmation, onError)\n  }, [purchaseDaiFund, amount, addTransaction])\n\n  const onRedeem = useCallback(async () => {\n    const amountParsed = new BigNumber(amount).times(1e18).toString()\n    const onTransactionHash = hash => {\n      addTransaction(hash)\n    }\n    const onConfirmation = () => {\n      setAmount('')\n    }\n    const onError = () => {\n      setAmount('')\n    }\n    redeemDaiFund(amountParsed, onTransactionHash, onConfirmation, onError)\n  }, [redeemDaiFund, amount, addTransaction])\n\n  const canPurchase = Date.now() < purchaseExpiringDate\n\n  const canRedeem = Date.now() > redeemStartingDate\n\n  const renderPurchaseButton = () => {\n    if (!daiAllowance || !amount) {\n      return <PurchaseButton disabled>Purchase</PurchaseButton>\n    } else if (daiApprovePending) {\n      return <PurchaseButton disabled>Pending...</PurchaseButton>\n    } else if (daiAllowance.lt(amount)) {\n      return (\n        <PurchaseButton onClick={onApprove} disabled={!connected}>\n          Unlock\n        </PurchaseButton>\n      )\n    } else {\n      return (\n        <PurchaseButton onClick={onPurchase} disabled={!connected}>\n          Purchase\n        </PurchaseButton>\n      )\n    }\n  }\n\n  const renderPurchaseForm = () => {\n    if (canPurchase) {\n      return (\n        <PurchaseForm>\n          <PurchaseInputField>\n            <input\n              type='number'\n              placeholder='0.0'\n              value={amount}\n              onChange={event => {\n                setAmount(event.target.value)\n              }}\n            />\n            <span className='suffix'>DAI</span>\n          </PurchaseInputField>\n          {renderPurchaseButton()}\n        </PurchaseForm>\n      )\n    } else if (canRedeem) {\n      return (\n        <PurchaseForm>\n          <PurchaseInputField>\n            <input\n              type='number'\n              placeholder='0.0'\n              value={amount}\n              onChange={event => {\n                setAmount(event.target.value)\n              }}\n            />\n            <span className='suffix'>ETH</span>\n          </PurchaseInputField>\n          <PurchaseButton onClick={onRedeem} disabled={!connected}>\n            Redeem\n          </PurchaseButton>\n        </PurchaseForm>\n      )\n    } else {\n      return (\n        <PurchaseInfo>\n          <SubTitle>The fund is in the locked period.</SubTitle>\n        </PurchaseInfo>\n      )\n    }\n  }\n\n  return (\n    <Container>\n      <Row>\n        <DataBlock strong>\n          <Title>Profit Rate</Title>\n          <StrongText>\n            {rate ? `${rate.times(100).toString()}%` : '-'}\n          </StrongText>\n        </DataBlock>\n        <DataBlock>\n          <Title>Pool (DAI)</Title>\n          <StrongText>\n            {daiPool ? amountFormatter(daiPool, 18) : '-'}\n          </StrongText>\n        </DataBlock>\n        <DataBlock>\n          <Title>Investors</Title>\n          <StrongText>{daiInvestorAmount || '-'}</StrongText>\n        </DataBlock>\n      </Row>\n      <Row>\n        <PurchaseBlock>\n          <PurchaseBlockTop>\n            <PurchaseInfo>\n              <Title>\n                <Bold>\n                  Already Bought{' '}\n                  {daiFundUnits ? amountFormatter(daiFundUnits, 18) : '0'}{' '}\n                  units.\n                </Bold>\n              </Title>\n              <SubTitle>\n                Your Balance:{' '}\n                {daiBalance ? amountFormatter(daiBalance, 18) : '-'} DAI\n              </SubTitle>\n            </PurchaseInfo>\n            {renderPurchaseForm()}\n          </PurchaseBlockTop>\n          <PurchaseBlockBottom>\n            <PurchaseDate>\n              <div className='item'>\n                <Item />\n                <Text>\n                  Purchase Due Date:{' '}\n                  {purchaseExpiringDate\n                    ? dateFormatter(purchaseExpiringDate)\n                    : '-'}\n                </Text>\n              </div>\n              <div className='item'>\n                <Item />\n                <Text>\n                  Redeem Starting Date:{' '}\n                  {redeemStartingDate ? dateFormatter(redeemStartingDate) : '-'}\n                </Text>\n              </div>\n            </PurchaseDate>\n          </PurchaseBlockBottom>\n        </PurchaseBlock>\n      </Row>\n      <Row justifyBetween>\n        <Headline>Estimated Ether Price that you will get...</Headline>\n        <SubTitle>Unit: USD/ETH</SubTitle>\n      </Row>\n      <SubRow>\n        <DataBlock>\n          <Title>Current Price</Title>\n          <StrongText>\n            {currentEthPrice ? currentEthPrice.toFixed(2) : '-'}\n          </StrongText>\n        </DataBlock>\n        <DataBlock>\n          <Title>Full Profits</Title>\n          <StrongText>\n            {priceToGetFullProfit ? priceToGetFullProfit.toFixed(2) : '-'}\n          </StrongText>\n        </DataBlock>\n        <DataBlock>\n          <Title>Loss</Title>\n          <StrongText>\n            {priceToGetLoss ? priceToGetLoss.toFixed(2) : '-'}\n          </StrongText>\n        </DataBlock>\n      </SubRow>\n      <SubRow>\n        <DataBlock>\n          <div style={{ width: '90%', height: '300px' }}>\n            <PriceBarChart data={chartData} />\n          </div>\n        </DataBlock>\n      </SubRow>\n    </Container>\n  )\n}\n"],"sourceRoot":""}